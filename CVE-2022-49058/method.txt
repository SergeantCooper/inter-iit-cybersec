I was not able to fully exploit the vulnerability. According to me it was not exploitable becasue in the source code before the buffer is read it is checked that the size of the file is equal to 1067 bytes and if it exceeds it returns before the read.


Method

1. Create a samba server
2. Create a malicious symlink with mfsymlink format on the server
3. mount the server using cifs utils on the client
4. execute the malicious payload using readlink.
